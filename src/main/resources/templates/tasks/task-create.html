<!DOCTYPE html>
<html lang="ja" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>代行依頼を投稿 - TaskHelper | 近所の信頼できる代行サービス</title>
  
  <!-- CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Suppress Tailwind CDN production warning for development
    tailwind.config = {
      corePlugins: {
        preflight: false,
      }
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- CSS Libraries -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  
  <!-- Additional UI Libraries -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.10.1/sweetalert2.min.css" rel="stylesheet">
  
  <!-- Alpine.js and Headless UI -->
  <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/focus@3.x.x/dist/cdn.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  
  <!-- Custom CSS -->
  <style>
    * {
      box-sizing: border-box;
    }
    
    a {
      text-decoration: none;
    }
    
    a:hover {
      text-decoration: none;
    }
    
    .error-field {
      border-color: #dc2626 !important;
      background-color: #fef2f2 !important;
    }
    
    .success-field {
      border-color: #10b981 !important;
      background-color: #f0fdf4 !important;
    }

    .category-card {
      transition: all 0.3s ease;
    }

    .category-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }

    .category-card.selected {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
    }

    .category-card.selected .category-inner {
      border-color: #2563eb !important;
      background-color: #f8fafc !important;
      border-width: 3px !important;
    }
    
    .category-card .category-inner {
      background-color: white;
      border-radius: 40px !important;
    }
    
    .category-inner {
      border-radius: 50px !important;
      -webkit-border-radius: 50px !important;
      -moz-border-radius: 50px !important;
    }
    
    @media (max-width: 640px) {
      input, textarea {
        max-width: 100% !important;
        width: 100% !important;
        box-sizing: border-box !important;
      }
      
      .relative {
        width: 100% !important;
        max-width: 100% !important;
      }
      
      .flex.items-start {
        align-items: flex-start !important;
        justify-content: flex-start !important;
        flex-wrap: nowrap !important;
      }
      
      .flex.items-start label {
        margin-left: 0 !important;
        flex: 1 !important;
        min-width: 0 !important;
      }
      
      .flex.items-start input[type="checkbox"] {
        flex-shrink: 0 !important;
        margin-top: 4px !important;
        margin-left: 0 !important;
        margin-right: 8px !important;
        width: 16px !important;
        height: 16px !important;
      }
    }
    
    @media (min-width: 641px) and (max-width: 768px) {
      .flex.items-start label {
        margin-left: 12px !important;
      }
    }
    
    .flex.items-start {
      align-items: flex-start;
    }
    
    .flex.items-start input[type="checkbox"] {
      margin-top: 2px;
      flex-shrink: 0;
    }
    
    .flex.items-start label {
      margin-left: 12px;
      flex: 1;
    }

    .category-card .check-mark {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 24px;
      height: 24px;
      background-color: #2563eb;
      border-radius: 50%;
      display: none;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 12px;
      z-index: 10;
    }

    .category-card.selected .check-mark {
      display: flex;
    }
  </style>
  
</head>
<body class="bg-gray-50" style="font-family: Inter, sans-serif;">

<!-- Navigation -->
<nav class="bg-white/95 backdrop-blur-lg border-b border-gray-100 fixed top-0 left-0 right-0 z-50 shadow-sm">
  <div class="max-w-7xl mx-auto px-4">
    <div class="flex items-center h-16">
      <!-- Logo -->
      <div class="flex items-center space-x-2">
        <div class="w-8 h-8 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg flex items-center justify-center">
          <i class="fas fa-hands-helping text-white text-sm" aria-hidden="true"></i>
        </div>
        <span class="text-xl font-bold text-gray-900">TaskHelper</span>
      </div>
      
      <!-- Desktop Mega Menu -->
      <div class="hidden lg:flex items-center space-x-1 mx-auto">
        <!-- ホーム -->
        <a href="../index.html" class="px-4 py-2 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 font-medium">
          <i class="fas fa-home mr-2"></i>ホーム
        </a>

        <!-- タスク (Mega Menu) - Current Page Highlighted -->
        <div class="relative group">
          <button class="px-4 py-2 text-blue-600 font-semibold bg-blue-50 rounded-lg transition-all duration-200 font-medium flex items-center">
            <i class="fas fa-tasks mr-2"></i>タスク
            <i class="fas fa-chevron-down ml-1 text-xs transition-transform duration-200 group-hover:rotate-180"></i>
          </button>
          
          <!-- Mega Menu Dropdown -->
          <div class="absolute top-full left-0 mt-2 w-96 bg-white rounded-2xl shadow-2xl border border-gray-100 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform translate-y-2 group-hover:translate-y-0">
            <div class="p-6">
              <div class="grid grid-cols-1 gap-4">
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center">
                    <i class="fas fa-plus-circle text-green-500 mr-2"></i>タスク管理
                  </h3>
                  <div class="space-y-2">
                    <a href="task-create.html" class="flex items-center p-3 rounded-lg bg-blue-50 border border-blue-200 transition-colors group/item">
                      <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-plus text-green-600"></i>
                      </div>
                      <div>
                        <div class="font-medium text-blue-600">タスク作成</div>
                        <div class="text-sm text-gray-500">新しい依頼を投稿</div>
                      </div>
                    </a>
                    <a href="task-list.html" class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-list text-blue-600"></i>
                      </div>
                      <div>
                        <div class="font-medium text-gray-900 group-hover/item:text-blue-600">タスク一覧</div>
                        <div class="text-sm text-gray-500">依頼を探す・応募</div>
                      </div>
                    </a>
                    <a href="my-tasks.html" class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-clipboard-list text-purple-600"></i>
                      </div>
                      <div>
                        <div class="font-medium text-gray-900 group-hover/item:text-purple-600">マイタスク</div>
                        <div class="text-sm text-gray-500">進行中・完了済み</div>
                      </div>
                    </a>
                    <a href="task-progress.html" class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-chart-line text-orange-600"></i>
                      </div>
                      <div>
                        <div class="font-medium text-gray-900 group-hover/item:text-orange-600">進行状況</div>
                        <div class="text-sm text-gray-500">リアルタイム追跡</div>
                      </div>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- プロフィール & アカウント (Mega Menu) -->
        <div class="relative group">
          <button class="px-4 py-2 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 font-medium flex items-center">
            <i class="fas fa-user mr-2"></i>アカウント
            <i class="fas fa-chevron-down ml-1 text-xs transition-transform duration-200 group-hover:rotate-180"></i>
          </button>
          
          <div class="absolute top-full left-0 mt-2 w-96 bg-white rounded-2xl shadow-2xl border border-gray-100 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform translate-y-2 group-hover:translate-y-0">
            <div class="p-6">
              <div class="grid grid-cols-1 gap-4">
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center">
                    <i class="fas fa-user-circle text-blue-500 mr-2"></i>プロフィール
                  </h3>
                  <div class="space-y-2">
                    <a href="../user/profile.html" class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-user text-blue-600"></i>
                      </div>
                      <div>
                        <div class="font-medium text-gray-900 group-hover/item:text-blue-600">マイプロフィール</div>
                        <div class="text-sm text-gray-500">基本情報・設定</div>
                      </div>
                    </a>
                    <a href="../user/user-profile-public.html" class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-eye text-green-600"></i>
                      </div>
                      <div>
                        <div class="font-medium text-gray-900 group-hover/item:text-green-600">公開プロフィール</div>
                        <div class="text-sm text-gray-500">他ユーザーから見た画面</div>
                      </div>
                    </a>
                    <a href="../user/settings.html" class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-cog text-gray-600"></i>
                      </div>
                      <div>
                        <div class="font-medium text-gray-900 group-hover/item:text-gray-600">設定</div>
                        <div class="text-sm text-gray-500">通知・プライバシー</div>
                      </div>
                    </a>
                    <a href="../user/notifications.html" class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <div class="w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-bell text-yellow-600"></i>
                      </div>
                      <div>
                        <div class="font-medium text-gray-900 group-hover/item:text-yellow-600">通知</div>
                        <div class="text-sm text-gray-500">メッセージ・更新情報</div>
                      </div>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- コミュニティ (Mega Menu) -->
        <div class="relative group">
          <button class="px-4 py-2 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 font-medium flex items-center">
            <i class="fas fa-users mr-2"></i>コミュニティ
            <i class="fas fa-chevron-down ml-1 text-xs transition-transform duration-200 group-hover:rotate-180"></i>
          </button>
          
          <div class="absolute top-full left-0 mt-2 w-96 bg-white rounded-2xl shadow-2xl border border-gray-100 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform translate-y-2 group-hover:translate-y-0">
            <div class="p-6">
              <div class="grid grid-cols-1 gap-4">
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center">
                    <i class="fas fa-trophy text-yellow-500 mr-2"></i>コミュニティ & 成果
                  </h3>
                  <div class="space-y-2">
                    <a href="../helper/leaderboard.html" class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <div class="w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-ranking-star text-yellow-600"></i>
                      </div>
                      <div>
                        <div class="font-medium text-gray-900 group-hover/item:text-yellow-600">ランキング</div>
                        <div class="text-sm text-gray-500">トップヘルパー</div>
                      </div>
                    </a>
                    <a href="../helper/achievement-center.html" class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-medal text-purple-600"></i>
                      </div>
                      <div>
                        <div class="font-medium text-gray-900 group-hover/item:text-purple-600">成果センター</div>
                        <div class="text-sm text-gray-500">バッジ・レベル</div>
                      </div>
                    </a>
                    <a href="../support/testimonials.html" class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-quote-right text-green-600"></i>
                      </div>
                      <div>
                        <div class="font-medium text-gray-900 group-hover/item:text-green-600">お客様の声</div>
                        <div class="text-sm text-gray-500">レビュー・体験談</div>
                      </div>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- その他 (Mega Menu) -->
        <div class="relative group">
          <button class="px-4 py-2 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 font-medium flex items-center">
            <i class="fas fa-ellipsis-h mr-2"></i>その他
            <i class="fas fa-chevron-down ml-1 text-xs transition-transform duration-200 group-hover:rotate-180"></i>
          </button>
          
          <div class="absolute top-full right-0 mt-2 w-80 bg-white rounded-2xl shadow-2xl border border-gray-100 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform translate-y-2 group-hover:translate-y-0">
            <div class="p-6">
              <div class="space-y-4">
                <!-- 機能・ツール -->
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center">
                    <i class="fas fa-tools text-indigo-500 mr-2"></i>機能・ツール
                  </h3>
                  <div class="grid grid-cols-2 gap-2">
                    <a href="../misc/search.html" class="flex flex-col items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <i class="fas fa-search text-gray-600 mb-1"></i>
                      <span class="text-xs font-medium">検索</span>
                    </a>
                    <a href="../user/messages.html" class="flex flex-col items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <i class="fas fa-comments text-blue-600 mb-1"></i>
                      <span class="text-xs font-medium">メッセージ</span>
                    </a>
                    <a href="../user/favorites.html" class="flex flex-col items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <i class="fas fa-heart text-red-600 mb-1"></i>
                      <span class="text-xs font-medium">お気に入り</span>
                    </a>
                    <a href="../misc/payment.html" class="flex flex-col items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <i class="fas fa-credit-card text-green-600 mb-1"></i>
                      <span class="text-xs font-medium">決済</span>
                    </a>
                    <a href="../helper/earnings.html" class="flex flex-col items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <i class="fas fa-yen-sign text-purple-600 mb-1"></i>
                      <span class="text-xs font-medium">収益</span>
                    </a>
                    <a href="../user/reviews.html" class="flex flex-col items-center p-3 rounded-lg hover:bg-gray-50 transition-colors group/item">
                      <i class="fas fa-star text-yellow-600 mb-1"></i>
                      <span class="text-xs font-medium">レビュー</span>
                    </a>
                  </div>
                </div>

                <!-- サポート -->
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center">
                    <i class="fas fa-life-ring text-orange-500 mr-2"></i>サポート
                  </h3>
                  <div class="space-y-2">
                    <a href="../support/help.html" class="flex items-center p-2 rounded-lg hover:bg-gray-50 transition-colors text-sm">
                      <i class="fas fa-question-circle text-blue-600 mr-3"></i>
                      ヘルプセンター
                    </a>
                    <a href="../support/dispute-resolution.html" class="flex items-center p-2 rounded-lg hover:bg-gray-50 transition-colors text-sm">
                      <i class="fas fa-gavel text-red-600 mr-3"></i>
                      紛争解決
                    </a>
                    <a href="../support/onboarding-guide.html" class="flex items-center p-2 rounded-lg hover:bg-gray-50 transition-colors text-sm">
                      <i class="fas fa-route text-purple-600 mr-3"></i>
                      ガイドツアー
                    </a>
                  </div>
                </div>

                <!-- 会社情報 -->
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center">
                    <i class="fas fa-building text-gray-500 mr-2"></i>会社情報
                  </h3>
                  <div class="grid grid-cols-2 gap-2 text-xs">
                    <a href="../support/about.html" class="p-2 rounded-lg hover:bg-gray-50 transition-colors text-center">会社概要</a>
                    <a href="../support/terms.html" class="p-2 rounded-lg hover:bg-gray-50 transition-colors text-center">利用規約</a>
                    <a href="../support/privacy-policy.html" class="p-2 rounded-lg hover:bg-gray-50 transition-colors text-center">プライバシー</a>
                    <a href="../helper/helper-onboarding.html" class="p-2 rounded-lg hover:bg-gray-50 transition-colors text-center">ヘルパー登録</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Auth Buttons -->
      <div class="hidden lg:flex items-center space-x-3">
        <a href="../auth/login.html" class="border border-blue-600 text-blue-600 px-6 py-2 rounded-lg font-semibold hover:bg-blue-50 transition-all duration-200 hover:scale-105">ログイン</a>
        <a href="../auth/register.html" class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2 rounded-lg font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 hover:scale-105 shadow-lg">始める</a>
      </div>
      
      <!-- Mobile Menu Button -->
      <div class="lg:hidden ml-auto">
        <button id="mobile-menu-button" class="text-gray-700 hover:text-blue-600 p-2 transition-all duration-300 ease-in-out" aria-expanded="false">
          <svg class="w-6 h-6 transition-transform duration-300 ease-in-out" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path id="menu-icon" class="transition-opacity duration-300" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            <path id="close-icon" class="transition-opacity duration-300 opacity-0" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    </div>
    
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden lg:hidden pb-4 transition-all duration-300 ease-in-out transform border-t border-gray-100 mt-4">
      <div class="flex flex-col space-y-1 pt-4">
        <!-- 基本メニュー -->
        <a href="../index.html" class="flex items-center px-4 py-3 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
          <i class="fas fa-home mr-3 w-5"></i>ホーム
        </a>
        <a href="task-list.html" class="flex items-center px-4 py-3 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
          <i class="fas fa-list mr-3 w-5"></i>タスク一覧
        </a>
        <a href="task-create.html" class="flex items-center px-4 py-3 text-blue-600 font-semibold bg-blue-50 rounded-lg transition-colors">
          <i class="fas fa-plus mr-3 w-5"></i>タスク作成
        </a>
        <a href="my-tasks.html" class="flex items-center px-4 py-3 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
          <i class="fas fa-clipboard-list mr-3 w-5"></i>マイタスク
        </a>
        
        <!-- 展開可能セクション -->
        <div class="mobile-section">
          <button class="mobile-section-toggle w-full flex items-center justify-between px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors" data-target="profile-section">
            <span class="flex items-center">
              <i class="fas fa-user mr-3 w-5"></i>プロフィール
            </span>
            <i class="fas fa-chevron-down transition-transform duration-200"></i>
          </button>
          <div id="profile-section" class="hidden pl-8 space-y-1">
            <a href="../user/profile.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-user-circle mr-3 w-4"></i>マイプロフィール
            </a>
            <a href="../user/settings.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-cog mr-3 w-4"></i>設定
            </a>
            <a href="../user/notifications.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-bell mr-3 w-4"></i>通知
            </a>
          </div>
        </div>

        <div class="mobile-section">
          <button class="mobile-section-toggle w-full flex items-center justify-between px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors" data-target="community-section">
            <span class="flex items-center">
              <i class="fas fa-users mr-3 w-5"></i>コミュニティ
            </span>
            <i class="fas fa-chevron-down transition-transform duration-200"></i>
          </button>
          <div id="community-section" class="hidden pl-8 space-y-1">
            <a href="../helper/leaderboard.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-trophy mr-3 w-4"></i>ランキング
            </a>
            <a href="../helper/achievement-center.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-medal mr-3 w-4"></i>成果センター
            </a>
            <a href="../support/testimonials.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-quote-right mr-3 w-4"></i>お客様の声
            </a>
          </div>
        </div>

        <div class="mobile-section">
          <button class="mobile-section-toggle w-full flex items-center justify-between px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors" data-target="tools-section">
            <span class="flex items-center">
              <i class="fas fa-tools mr-3 w-5"></i>ツール
            </span>
            <i class="fas fa-chevron-down transition-transform duration-200"></i>
          </button>
          <div id="tools-section" class="hidden pl-8 space-y-1">
            <a href="../misc/search.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-search mr-3 w-4"></i>検索
            </a>
            <a href="../user/messages.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-comments mr-3 w-4"></i>メッセージ
            </a>
            <a href="../user/favorites.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-heart mr-3 w-4"></i>お気に入り
            </a>
            <a href="../misc/payment.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-credit-card mr-3 w-4"></i>決済
            </a>
            <a href="../helper/earnings.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-yen-sign mr-3 w-4"></i>収益
            </a>
          </div>
        </div>

        <div class="mobile-section">
          <button class="mobile-section-toggle w-full flex items-center justify-between px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors" data-target="support-section">
            <span class="flex items-center">
              <i class="fas fa-life-ring mr-3 w-5"></i>サポート
            </span>
            <i class="fas fa-chevron-down transition-transform duration-200"></i>
          </button>
          <div id="support-section" class="hidden pl-8 space-y-1">
            <a href="../support/help.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-question-circle mr-3 w-4"></i>ヘルプ
            </a>
            <a href="../support/dispute-resolution.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-gavel mr-3 w-4"></i>紛争解決
            </a>
            <a href="../support/onboarding-guide.html" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
              <i class="fas fa-route mr-3 w-4"></i>ガイドツアー
            </a>
          </div>
        </div>
        
        <!-- 認証ボタン -->
        <hr class="my-4">
        <div class="flex gap-3 px-4">
          <a href="../auth/login.html" class="flex-1 border border-blue-600 text-blue-600 px-4 py-3 rounded-lg font-semibold hover:bg-blue-50 text-center transition-colors">ログイン</a>
          <a href="../auth/register.html" class="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-3 rounded-lg font-semibold hover:from-blue-700 hover:to-purple-700 text-center transition-colors">始める</a>
        </div>
      </div>
    </div>
  </div>
</nav>

<!-- Main Content -->
<section class="bg-gradient-to-r from-blue-500 to-purple-600 text-white py-20 pt-32" aria-labelledby="create-task-title">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="text-center mb-12">
      <h1 id="create-task-title" class="text-3xl sm:text-4xl font-bold mb-4">
        代行依頼を投稿
      </h1>  
      <p class="text-lg text-blue-100">
        お困りのことがあれば、近所のヘルパーに依頼してみましょう
      </p>
      <div class="w-20 h-1 bg-white mx-auto mt-4 rounded-full"></div>
    </div>

    <!-- Task Creation Form -->
    <div class="bg-white rounded-2xl shadow-lg p-4 sm:p-6 lg:p-8">
      <form id="createTaskForm" class="space-y-8" novalidate>
        
        <!-- Step 1: Category Selection -->
        <div class="space-y-6">
          <div class="flex items-center space-x-2 mb-6">
            <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold">1</div>
            <h2 class="text-xl font-semibold text-gray-900">カテゴリを選択 <span class="text-red-500">*</span></h2>
          </div>
          
          <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 ml-8 sm:ml-10">
            <label class="category-card relative">
              <input type="radio" name="category" value="shopping" class="sr-only category-radio" required>
              <div class="category-inner border border-gray-200 p-4 text-center cursor-pointer">
                <div class="check-mark">
                  <i class="fas fa-check"></i>
                </div>
                <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3">
                  <i class="fas fa-shopping-cart text-green-600 text-xl"></i>
                </div>
                <h3 class="font-semibold text-gray-900 text-sm">買い物</h3>
                <p class="text-xs text-gray-600 mt-1">スーパー、コンビニ</p>
              </div>
            </label>

            <label class="category-card relative">
              <input type="radio" name="category" value="cleaning" class="sr-only category-radio" required>
              <div class="category-inner border border-gray-200 p-4 text-center cursor-pointer">
                <div class="check-mark">
                  <i class="fas fa-check"></i>
                </div>
                <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3">
                  <i class="fas fa-broom text-blue-600 text-xl"></i>
                </div>
                <h3 class="font-semibold text-gray-900 text-sm">掃除</h3>
                <p class="text-xs text-gray-600 mt-1">家の片付け、掃除</p>
              </div>
            </label>

            <label class="category-card relative">
              <input type="radio" name="category" value="delivery" class="sr-only category-radio" required>
              <div class="category-inner border border-gray-200 p-4 text-center cursor-pointer">
                <div class="check-mark">
                  <i class="fas fa-check"></i>
                </div>
                <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-3">
                  <i class="fas fa-truck text-orange-600 text-xl"></i>
                </div>
                <h3 class="font-semibold text-gray-900 text-sm">配送</h3>
                <p class="text-xs text-gray-600 mt-1">荷物の配送</p>
              </div>
            </label>

            <label class="category-card relative">
              <input type="radio" name="category" value="petcare" class="sr-only category-radio" required>
              <div class="category-inner border border-gray-200 p-4 text-center cursor-pointer">
                <div class="check-mark">
                  <i class="fas fa-check"></i>
                </div>
                <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3">
                  <i class="fas fa-paw text-purple-600 text-xl"></i>
                </div>
                <h3 class="font-semibold text-gray-900 text-sm">ペットケア</h3>
                <p class="text-xs text-gray-600 mt-1">散歩、お世話</p>
              </div>
            </label>

            <label class="category-card relative">
              <input type="radio" name="category" value="repair" class="sr-only category-radio" required>
              <div class="category-inner border border-gray-200 p-4 text-center cursor-pointer">
                <div class="check-mark">
                  <i class="fas fa-check"></i>
                </div>
                <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3">
                  <i class="fas fa-tools text-red-600 text-xl"></i>
                </div>
                <h3 class="font-semibold text-gray-900 text-sm">修理</h3>
                <p class="text-xs text-gray-600 mt-1">組み立て、小修理</p>
              </div>
            </label>
          </div>
          <p id="categoryError" class="text-xs mt-1 text-red-500 hidden ml-8 sm:ml-10"></p>
        </div>

        <!-- Step 2: Task Details -->
        <div class="space-y-6">
          <div class="flex items-center space-x-2 mb-6">
            <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold">2</div>
            <h2 class="text-xl font-semibold text-gray-900">依頼内容</h2>
          </div>

          <div class="space-y-1 ml-8 sm:ml-10">
            <label for="title" class="block text-sm font-medium text-gray-700">タイトル <span class="text-red-500">*</span></label>
            <div class="relative w-full">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-edit text-gray-400 text-sm" aria-hidden="true"></i>
              </div>
              <input type="text" id="title" name="title" required
                     maxlength="50" minlength="5"
                     class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl bg-gray-50/50 focus:bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 placeholder-gray-400"
                     placeholder="例：買い物代行をお願いします">
            </div>
            <p id="titleError" class="text-xs mt-1 text-red-500 hidden"></p>
          </div>

          <div class="space-y-1 ml-8 sm:ml-10">
            <label for="description" class="block text-sm font-medium text-gray-700">詳細説明 <span class="text-red-500">*</span></label>
            <div class="w-full">
              <textarea id="description" name="description" required
                        rows="4" maxlength="500" minlength="15"
                        class="w-full px-4 py-3 border border-gray-300 rounded-xl bg-gray-50/50 focus:bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 placeholder-gray-400"
                        placeholder="依頼の詳細を具体的に書いてください。"></textarea>
              <div class="flex justify-between text-xs text-gray-500">
                <span>15文字以上入力してください</span>
                <span id="charCount">0/500</span>
              </div>
            </div>
            <p id="descriptionError" class="text-xs mt-1 text-red-500 hidden"></p>
          </div>
        </div>

        <!-- Step 3: Location & Schedule -->
        <div class="space-y-6">
          <div class="flex items-center space-x-2 mb-6">
            <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold">3</div>
            <h2 class="text-xl font-semibold text-gray-900">場所と日時</h2>
          </div>

          <div class="grid md:grid-cols-2 gap-6 max-w-4xl ml-8 sm:ml-10">
            <div class="space-y-1">
              <label for="location" class="block text-sm font-medium text-gray-700">実施場所 <span class="text-red-500">*</span></label>
              <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <i class="fas fa-map-marker-alt text-gray-400 text-sm" aria-hidden="true"></i>
                </div>
                <input type="text" id="location" name="location" required
                       maxlength="100"
                       class="max-w-xs w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl bg-gray-50/50 focus:bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 placeholder-gray-400"
                       placeholder="例：渋谷区恵比寿">
              </div>
              <p class="text-xs text-gray-500 mt-1">正確にご記入ください（ヘルパーが見つけやすくなります）</p>
              <p id="locationError" class="text-xs mt-1 text-red-500 hidden"></p>
            </div>

            <div class="space-y-1">
              <label for="budget" class="block text-sm font-medium text-gray-700">予算 <span class="text-red-500">*</span></label>
              <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <span class="text-gray-400 text-sm">¥</span>
                </div>
                <input type="number" id="budget" name="budget" required
                       min="500" max="50000" step="100"
                       class="max-w-48 w-full pl-8 pr-8 py-3 border border-gray-300 rounded-xl bg-gray-50/50 focus:bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 placeholder-gray-400"
                       placeholder="3000 円">
              </div>
              <p class="text-xs text-gray-500 mt-1">サービス手数料別途</p>
              <p id="budgetError" class="text-xs mt-1 text-red-500 hidden"></p>
            </div>
          </div>

          <div class="grid md:grid-cols-2 gap-6 max-w-4xl ml-8 sm:ml-10">
            <div class="space-y-1">
              <label for="preferred_date" class="block text-sm font-medium text-gray-700">希望日 <span class="text-red-500">*</span></label>
              <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <i class="fas fa-calendar text-gray-400 text-sm" aria-hidden="true"></i>
                </div>
                <input type="date" id="preferred_date" name="preferred_date" required
                       class="max-w-xs w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl bg-gray-50/50 focus:bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200">
              </div>
              <p id="dateError" class="text-xs mt-1 text-red-500 hidden"></p>
            </div>

            <div class="space-y-1">
              <label for="preferred_time" class="block text-sm font-medium text-gray-700">希望時間 <span class="text-red-500">*</span></label>
              <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <i class="fas fa-clock text-gray-400 text-sm" aria-hidden="true"></i>
                </div>
                <select id="preferred_time" name="preferred_time" required
                        class="max-w-sm w-full pl-10 pr-10 py-3 border border-gray-300 rounded-xl bg-gray-50/50 focus:bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 appearance-none">
                  <option value="">時間を選択</option>
                  <option value="morning">午前中 (9:00-12:00)</option>
                  <option value="afternoon">午後 (13:00-17:00)</option>
                  <option value="evening">夕方 (17:00-20:00)</option>
                  <option value="anytime">いつでも</option>
                </select>
                <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                  <i class="fas fa-chevron-down text-gray-400 text-sm"></i>
                </div>
              </div>
              <p id="timeError" class="text-xs mt-1 text-red-500 hidden"></p>
            </div>
          </div>
        </div>

        <!-- Step 4: Additional Options -->
        <div class="space-y-6">
          <div class="flex items-center space-x-2 mb-6">
            <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold">4</div>
            <h2 class="text-xl font-semibold text-gray-900">追加オプション</h2>
          </div>

          <div class="space-y-4 ml-8 sm:ml-10">
            <div class="flex items-start">
              <input type="checkbox" id="urgent" name="urgent" class="w-4 h-4 mt-1 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
              <label for="urgent" class="ml-3 text-sm text-gray-700">
                <span class="font-medium">緊急依頼</span>
                <span class="block text-gray-500">24時間以内に実施希望（追加料金 +20%）</span>
              </label>
            </div>

            <div class="flex items-start">
              <input type="checkbox" id="photo_required" name="photo_required" class="w-4 h-4 mt-1 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
              <label for="photo_required" class="ml-3 text-sm text-gray-700">
                <span class="font-medium">完了写真を希望</span>
                <span class="block text-gray-500">作業完了時の写真撮影をお願いします</span>
              </label>
            </div>

            <div class="flex items-start">
              <input type="checkbox" id="contact_phone" name="contact_phone" class="w-4 h-4 mt-1 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
              <label for="contact_phone" class="ml-3 text-sm text-gray-700">
                <span class="font-medium">電話連絡可能</span>
                <span class="block text-gray-500">緊急時に電話での連絡を許可します</span>
              </label>
            </div>
          </div>
        </div>

        <!-- Submit Section -->
        <div class="border-t pt-6">
          <div class="bg-blue-50 rounded-xl p-4 mb-6">
            <div class="flex items-start">
              <i class="fas fa-info-circle text-blue-600 mt-1 mr-3"></i>
              <div class="text-sm text-blue-800">
                <p class="font-medium mb-1">投稿前にご確認ください</p>
                <ul class="space-y-1 text-blue-700">
                  <li>依頼内容は具体的に記載してください</li>
                  <li>適正な予算を設定してください</li>
                  <li>ヘルパーからの質問には迅速に回答してください</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="flex justify-end gap-4">
            <button type="button" id="cancelBtn" 
                    class="px-6 py-3 border border-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200">
              <i class="fas fa-times mr-2"></i>
              キャンセル
            </button>
            <button type="button" id="previewBtn" 
                    class="px-6 py-3 border border-blue-600 text-blue-600 rounded-xl font-semibold hover:bg-blue-50 transition-all duration-200">
              <i class="fas fa-eye mr-2"></i>
              プレビュー
            </button>
            <button type="submit" id="submitBtn" 
                    class="px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl font-semibold hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all duration-200 border-0">
              <i class="fas fa-paper-plane mr-2"></i>
              依頼を登録
            </button>
          </div>
        </div>

      </form>
    </div>
  </div>
</section>

<!-- Footer -->
<footer class="bg-gray-900 text-white py-12">
  <div class="max-w-7xl mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <!-- Brand Section -->
      <div>
        <div class="flex items-center space-x-2 mb-4">
          <i class="fas fa-hands-helping text-2xl text-blue-500" aria-hidden="true"></i>
          <span class="text-xl font-bold">TaskHelper</span>
        </div>
        <p class="text-gray-400">近所の方々と一緒に信頼できる代行サービス</p>
      </div>
      
      <!-- Services Section -->
      <div>
        <h4 class="font-semibold mb-4">サービス</h4>
        <ul class="space-y-2 text-gray-400">
          <li><a href="task-list.html?category=shopping" class="hover:text-white transition-colors">買い物代行</a></li>
          <li><a href="task-list.html?category=cleaning" class="hover:text-white transition-colors">清掃サービス</a></li>
          <li><a href="task-list.html?category=delivery" class="hover:text-white transition-colors">配達・運搬</a></li>
          <li><a href="task-list.html?category=petcare" class="hover:text-white transition-colors">ペットケア</a></li>
        </ul>
      </div>
      
      <!-- Support Section -->
      <div>
        <h4 class="font-semibold mb-4">サポート</h4>
        <ul class="space-y-2 text-gray-400">
          <li><a href="#" class="hover:text-white transition-colors">ヘルプセンター</a></li>
          <li><a href="#" class="hover:text-white transition-colors">お問い合わせ</a></li>
          <li><a href="#" class="hover:text-white transition-colors">利用規約</a></li>
          <li><a href="#" class="hover:text-white transition-colors">プライバシーポリシー</a></li>
        </ul>
      </div>
      
      <!-- Follow Section -->
      <div>
        <h4 class="font-semibold mb-4">フォロー</h4>
        <div class="flex space-x-4">
          <a href="#" class="text-gray-400 hover:text-white transition-colors" aria-label="Twitter">
            <i class="fab fa-twitter text-xl"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-white transition-colors" aria-label="Facebook">
            <i class="fab fa-facebook text-xl"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-white transition-colors" aria-label="Instagram">
            <i class="fab fa-instagram text-xl"></i>
          </a>
        </div>
      </div>
    </div>
    
    <!-- Copyright Section -->
    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 <span lang="en">TaskHelper</span>. <span lang="en">All rights reserved</span>.</p>
    </div>
  </div>
</footer>

<!-- JS Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.10.1/sweetalert2.all.min.js"></script>
<script>

document.addEventListener('DOMContentLoaded', function() {
  
  // Mobile menu functionality
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  
  if (mobileMenuButton && mobileMenu) {
    mobileMenuButton.addEventListener('click', function() {
      const isExpanded = this.getAttribute('aria-expanded') === 'true';
      this.setAttribute('aria-expanded', !isExpanded);
      mobileMenu.classList.toggle('hidden');
      
      // Toggle menu/close icons
      const menuIcon = document.getElementById('menu-icon');
      const closeIcon = document.getElementById('close-icon');
      if (menuIcon && closeIcon) {
        menuIcon.classList.toggle('opacity-0');
        closeIcon.classList.toggle('opacity-0');
      }
    });
  }

  // Configure Toastr
  toastr.options = {
    "closeButton": true,
    "progressBar": true,
    "positionClass": "toast-top-right",
    "timeOut": "4000"
  };

  // Character counter for description
  const descriptionTextarea = document.getElementById('description');
  const charCount = document.getElementById('charCount');
  
  if (descriptionTextarea && charCount) {
    descriptionTextarea.addEventListener('input', function() {
      const currentLength = this.value.length;
      charCount.textContent = `${currentLength}/500`;
      
      if (currentLength < 15) {
        charCount.classList.add('text-red-500');
        charCount.classList.remove('text-gray-500');
      } else {
        charCount.classList.remove('text-red-500');
        charCount.classList.add('text-gray-500');
      }
    });
  }

  // Set minimum date to today
  const dateInput = document.getElementById('preferred_date');
  if (dateInput) {
    const today = new Date().toISOString().split('T')[0];
    dateInput.min = today;
  }

  // Category selection
  document.querySelectorAll('.category-radio').forEach(radio => {
    radio.addEventListener('change', function() {
      // Remove selection from all cards
      document.querySelectorAll('.category-card').forEach(card => {
        card.classList.remove('selected');
      });

      // Add selection to chosen card
      const selectedCard = this.closest('.category-card');
      if (selectedCard) {
        selectedCard.classList.add('selected');
      }

      clearError('categoryError');
    });
  });

  // Real-time validation
  const formFields = ['title', 'description', 'location', 'budget', 'preferred_date', 'preferred_time'];
  
  formFields.forEach(fieldId => {
    const field = document.getElementById(fieldId);
    if (field) {
      field.addEventListener('input', function() {
        validateField(fieldId);
      });
      field.addEventListener('blur', function() {
        validateField(fieldId);
      });
    }
  });

  // Clear error function
  function clearError(errorId) {
    const errorElement = document.getElementById(errorId);
    if (errorElement) {
      errorElement.classList.add('hidden');
    }
  }

  // Field validation function
  function validateField(fieldId) {
    const field = document.getElementById(fieldId);
    const errorElement = document.getElementById(fieldId + 'Error');
    
    if (!field || !errorElement) {
      return true; // Skip validation if elements don't exist
    }
    
    const value = field.value.trim();
    
    // Clear previous error
    field.classList.remove('error-field');
    errorElement.classList.add('hidden');
    
    let isValid = true;
    let errorMessage = '';

    switch(fieldId) {
      case 'title':
        if (!value) {
          errorMessage = 'タイトルを入力してください。';
          isValid = false;
        } else if (value.length < 5) {
          errorMessage = 'タイトルは5文字以上で入力してください。';
          isValid = false;
        }
        break;
        
      case 'description':
        if (!value) {
          errorMessage = '詳細説明を入力してください。';
          isValid = false;
        } else if (value.length < 15) {
          errorMessage = '詳細説明は15文字以上で入力してください。';
          isValid = false;
        }
        break;
        
      case 'location':
        if (!value) {
          errorMessage = '実施場所を入力してください。';
          isValid = false;
        }
        break;
        
      case 'budget':
        const budgetValue = parseInt(value);
        if (!value) {
          errorMessage = '予算を入力してください。';
          isValid = false;
        } else if (budgetValue < 500) {
          errorMessage = '予算は500円以上で設定してください。';
          isValid = false;
        } else if (budgetValue > 50000) {
          errorMessage = '予算は50,000円以下で設定してください。';
          isValid = false;
        }
        break;
        
      case 'preferred_date':
        if (!value) {
          errorMessage = '希望日を選択してください。';
          isValid = false;
        } else {
          const selectedDate = new Date(value);
          const today = new Date();
          today.setHours(0, 0, 0, 0);
          
          if (selectedDate < today) {
            errorMessage = '本日以降の日付を選択してください。';
            isValid = false;
          }
        }
        break;
        
      case 'preferred_time':
        if (!value) {
          errorMessage = '希望時間を選択してください。';
          isValid = false;
        }
        break;
    }

    if (!isValid) {
      field.classList.add('error-field');
      errorElement.textContent = errorMessage;
      errorElement.classList.remove('hidden');
    }

    return isValid;
  }

  // Form validation
  function validateForm() {
    let isValid = true;

    // Validate category selection
    const categorySelected = document.querySelector('input[name="category"]:checked');
    if (!categorySelected) {
      document.getElementById('categoryError').textContent = 'カテゴリを選択してください。';
      document.getElementById('categoryError').classList.remove('hidden');
      isValid = false;
    } else {
      clearError('categoryError');
    }

    // Validate all fields
    formFields.forEach(fieldId => {
      if (!validateField(fieldId)) {
        isValid = false;
      }
    });

    return isValid;
  }

  // Preview functionality
  document.getElementById('previewBtn').addEventListener('click', function() {
    if (!validateForm()) {
      toastr.error('入力内容を確認してください。');
      return;
    }

    const categoryContainer = document.querySelector('[x-data*="categorySelector"]');
    let category = null;
    
    if (categoryContainer && typeof Alpine !== 'undefined') {
      try {
        const categoryComponent = Alpine.$data(categoryContainer);
        category = categoryComponent ? categoryComponent.selectedCategory : null;
      } catch (e) {
        console.warn('Could not access Alpine data, falling back to form data');
        const radioInput = document.querySelector('input[name="category"]:checked');
        category = radioInput ? radioInput.value : null;
      }
    } else {
      const radioInput = document.querySelector('input[name="category"]:checked');
      category = radioInput ? radioInput.value : null;
    }
    const formData = new FormData(document.getElementById('createTaskForm'));
    const title = formData.get('title');
    const description = formData.get('description');
    const location = formData.get('location');
    const budget = formData.get('budget');
    const date = formData.get('preferred_date');
    const time = formData.get('preferred_time');

    const categoryNames = {
      'shopping': '買い物',
      'cleaning': '掃除',
      'delivery': '配送',
      'petcare': 'ペットケア',
      'repair': '修理'
    };

    const timeNames = {
      'morning': '午前中 (9:00-12:00)',
      'afternoon': '午後 (13:00-17:00)',
      'evening': '夕方 (17:00-20:00)',
      'anytime': 'いつでも'
    };

    Swal.fire({
      title: 'プレビュー',
      html: `
        <div class="text-left space-y-4">
          <div>
            <span class="inline-block px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm font-medium">${categoryNames[category]}</span>
          </div>
          <h3 class="text-lg font-semibold">${title}</h3>
          <p class="text-gray-600 whitespace-pre-line">${description}</p>
          <div class="grid grid-cols-2 gap-4 text-sm">
            <div>
              <strong>場所:</strong> ${location}
            </div>
            <div>
              <strong>予算:</strong> ¥${parseInt(budget).toLocaleString()}
            </div>
            <div>
              <strong>希望日:</strong> ${date}
            </div>
            <div>
              <strong>希望時間:</strong> ${timeNames[time]}
            </div>
          </div>
        </div>
      `,
      width: '600px',
      confirmButtonText: '編集に戻る',
      confirmButtonColor: '#3b82f6'
    });
  });

  // Form submission
  document.getElementById('createTaskForm').addEventListener('submit', function(event) {
    event.preventDefault();
    
    if (!validateForm()) {
      toastr.error('入力内容を確認してください。');
      return;
    }

    const submitBtn = document.getElementById('submitBtn');
    
    // Simulate submission process
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>投稿中...';
    
    setTimeout(() => {
      Swal.fire({
        icon: 'success',
        title: '投稿完了！',
        text: '代行依頼が正常に投稿されました。ヘルパーからの応募をお待ちください。',
        timer: 3000,
        showConfirmButton: false
      });
      
      setTimeout(() => {
        // Redirect to dashboard or task list
        window.location.href = 'dashboard.html';
      }, 2000);
    }, 2000);
  });

  // Cancel button functionality
  document.getElementById('cancelBtn').addEventListener('click', function() {
    Swal.fire({
      title: '確認',
      text: '入力内容が破棄されます。よろしいですか？',
      icon: 'warning',
      showCancelButton: true,
      confirmButtonText: 'はい',
      cancelButtonText: 'いいえ',
      confirmButtonColor: '#d33'
    }).then((result) => {
      if (result.isConfirmed) {
        window.history.back();
      }
    });
  });

});

// Mega menu functionality
document.addEventListener('DOMContentLoaded', function() {
  // Mobile menu functionality
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuIcon = document.getElementById('menu-icon');
  const closeIcon = document.getElementById('close-icon');
  
  if (mobileMenuButton && mobileMenu) {
    mobileMenuButton.addEventListener('click', function() {
      const isExpanded = this.getAttribute('aria-expanded') === 'true';
      this.setAttribute('aria-expanded', !isExpanded);
      mobileMenu.classList.toggle('hidden');
      
      // Toggle menu/close icons
      if (menuIcon && closeIcon) {
        menuIcon.classList.toggle('opacity-0');
        closeIcon.classList.toggle('opacity-0');
      }
    });
  }

  // Mobile section toggles
  const sectionToggles = document.querySelectorAll('.mobile-section-toggle');
  sectionToggles.forEach(toggle => {
    toggle.addEventListener('click', function() {
      const targetId = this.getAttribute('data-target');
      const targetSection = document.getElementById(targetId);
      const chevron = this.querySelector('i:last-child');
      
      if (targetSection) {
        targetSection.classList.toggle('hidden');
        this.classList.toggle('active');
      }
    });
  });

  // Header scroll effect
  let lastScrollTop = 0;
  const header = document.querySelector('nav');
  
  window.addEventListener('scroll', function() {
    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    
    if (scrollTop > 100) {
      header.classList.add('header-scrolled');
    } else {
      header.classList.remove('header-scrolled');
    }
    
    lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
  });

  // Close mobile menu when clicking outside
  document.addEventListener('click', function(event) {
    if (mobileMenuButton && mobileMenu && 
        !mobileMenuButton.contains(event.target) && 
        !mobileMenu.contains(event.target)) {
      mobileMenu.classList.add('hidden');
      mobileMenuButton.setAttribute('aria-expanded', 'false');
      if (menuIcon && closeIcon) {
        menuIcon.classList.remove('opacity-0');
        closeIcon.classList.add('opacity-0');
      }
    }
  });

  // Keyboard navigation for accessibility
  document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
      mobileMenu.classList.add('hidden');
      mobileMenuButton.setAttribute('aria-expanded', 'false');
      if (menuIcon && closeIcon) {
        menuIcon.classList.remove('opacity-0');
        closeIcon.classList.add('opacity-0');
      }
    }
  });
});
</script>

<!-- Mega Menu CSS -->
<style>
/* メガメニューのアニメーション */
.group:hover .group-hover\:opacity-100 {
  animation: fadeInUp 0.3s ease-out;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ホバー効果の強化 */
.group\/item:hover {
  transform: translateX(4px);
}

/* モバイルセクションのアニメーション */
.mobile-section .mobile-section-toggle.active i {
  transform: rotate(180deg);
}

/* スクロール時のヘッダー効果 */
.header-scrolled {
  background: rgba(255, 255, 255, 0.98);
  backdrop-filter: blur(20px);
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}
</style>

</body>
</html>